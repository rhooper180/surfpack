# Load data from files
Load[name = topo_data, file = '../perm_data/noisysparsetopo.spd']

# Create a test data set
Load[name = topo_test, file = '../perm_data/noisydensetopo.spd']

# Create surfaces using existing data sets
CreateSurface[name = rbf_topo, data = topo_data, type = rbf]
! echo  rbf 
CreateSurface[name = poly0_topo, data = topo_data, type = polynomial,
 	      order = 0]
! echo  poly0
CreateSurface[name = poly1_topo, data = topo_data, type = polynomial,
 	      order = 1]
! echo  poly1
CreateSurface[name = poly2_topo, data = topo_data, type = polynomial,
 	      order = 2]
! echo  poly2
CreateSurface[name = poly3_topo, data = topo_data, type = polynomial,
 	      order = 3]
! echo  poly3
CreateSurface[name = krig_topo, data = topo_data, type = kriging, correlations = (1.0,1.0)]
! echo  krig
CreateSurface[name = mars_topo, data = topo_data, type = mars]
! echo  mars
#CreateSurface[name = ann_topo, data = topo_data, type = ann]
! echo  ann

# Save surfaces to file
Save[surface = poly0_topo, file = '../tmp_surf/poly0_topo.sps']
Save[surface = poly1_topo, file = '../tmp_surf/poly1_topo.sps']
Save[surface = poly2_topo, file = '../tmp_surf/poly2_topo.sps']
Save[surface = poly3_topo, file = '../tmp_surf/poly3_topo.sps']
Save[surface = krig_topo, file = '../tmp_surf/krig_topo.sps']
Save[surface = mars_topo, file = '../tmp_surf/mars_topo.sps']
#Save[surface = ann_topo, file = '../tmp_surf/ann_topo.sps']
#Save[surface = rbf_topo, file = '../tmp_surf/rbf_topo.sps']

# Evaluate surfaces 
Evaluate[surface = poly0_topo, data = topo_test]
! echo poly0 eval
Evaluate[surface = poly1_topo, data = topo_test]
! echo poly1 eval
Evaluate[surface = poly2_topo, data = topo_test]
! echo poly2 eval
Evaluate[surface = poly3_topo, data = topo_test]
! echo poly3 eval
Evaluate[surface = krig_topo, data = topo_test]
! echo krig eval
Evaluate[surface = mars_topo, data = topo_test]
! echo mars eval
#Evaluate[surface = ann_topo, data = topo_test]
Evaluate[surface = rbf_topo, data = topo_test]
! echo rbf eval

# Compute surface fitness metrics
Fitness[surface = poly0_topo, metric = mean_squared]
Fitness[surface = poly1_topo, metric = mean_squared]
Fitness[surface = poly2_topo, metric = mean_squared]
Fitness[surface = poly3_topo, metric = mean_squared]
Fitness[surface = krig_topo, metric = mean_squared]
Fitness[surface = mars_topo, metric = mean_squared]
#Fitness[surface = ann_topo, metric = mean_squared]
Fitness[surface = rbf_topo, metric = mean_squared]

# Save data to file
Save[data = topo_test, file = '../tmp_data/topo_test.spd']


#/*
#pushd ../tmp_data
#rm gnuplot_script 2> /dev/null 2
#echo "set term png; set output \"topo.png\";" > gnuplot_script
#echo plot [100:2400] [200:1000] \"./topo_test.txt\" using 1:2 >> gnuplot_script
#gnuplot gnuplot_script
#popd
#*/


